<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>QCheck2 (qcheck-core.QCheck2)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> ‚Äì <a href="../index.html">qcheck-core</a> &#x00BB; QCheck2</nav><header class="odoc-preamble"><h1>Module <code><span>QCheck2</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#quickcheck-inspired-property-based-testing">QuickCheck-inspired property-based testing</a></li><li><a href="#introduction">Introduction</a></li><li><a href="#examples">Examples</a><ul><li><a href="#assumptions">Assumptions</a></li></ul></li><li><a href="#tests">Tests</a><ul><li><a href="#sub-tests">Sub-tests</a></li></ul></li><li><a href="#migration_qcheck2">Migration to QCheck2</a><ul><li><a href="#minimal-changes">Minimal changes</a></li><li><a href="#recommended-changes">Recommended changes</a></li></ul></li></ul></nav><div class="odoc-content"><h2 id="quickcheck-inspired-property-based-testing"><a href="#quickcheck-inspired-property-based-testing" class="anchor"></a>QuickCheck-inspired property-based testing</h2><h2 id="introduction"><a href="#introduction" class="anchor"></a>Introduction</h2><p>This library takes inspiration from Haskell's QuickCheck library. The rough idea is that the programmer describes invariants that values of a certain type need to satisfy (&quot;properties&quot;), as functions from this type to bool. They also need to describe how to generate random values of the type, so that the property is tried and checked on a number of random instances.</p><p>This explains the organization of this module:</p><ul><li><a href="Gen/index.html"><code>Gen</code></a> is used to describe how to generate random values. Auxiliary module <a href="Print/index.html"><code>Print</code></a> can be used along with <a href="Test/index.html#val-make"><code>Test.make</code></a> to build one's own generator instances.</li></ul><ul><li><a href="Test/index.html"><code>Test</code></a> is used to describe a single test, that is, a property of type <code>'a -&gt; bool</code> combined with an <code>'a Gen.t</code> that is used to generate the test cases for this property. Optional parameters allow to specify the random generator state, number of instances to generate and test, etc.</li></ul><p>üí° If you are migrating from QCheck, check the <a href="#migration_qcheck2">migration guide</a> below.</p><h2 id="examples"><a href="#examples" class="anchor"></a>Examples</h2><ul><li>&quot;<code>List</code>.rev is involutive&quot; (the test passes so <code>check_exn</code> returns <code>()</code>):</li></ul><pre><code>let test =
  QCheck2.(Test.make ~count:1000
            ~print:Print.(list int)
            Gen.(list int)
            (fun l -&gt; List.rev (List.rev l) = l));;

QCheck2.Test.check_exn test;;</code></pre><ul><li><p>&quot;All lists are sorted&quot; (false property that will fail):</p><ul><li>QCheck tests this property on random lists and finds a counter-example</li><li>QCheck then looks for the smallest counter-example possible (here <code>[1; 0]</code>) to help you find the problem (called &quot;shrinking&quot;)</li></ul></li></ul><pre><code>let test = QCheck2.(
    Test.make
      ~name:&quot;All lists are sorted&quot;
      ~count:10_000
      ~print:Print.(list int)
      Gen.(list small_nat)
      (fun l -&gt; l = List.sort compare l));;

QCheck2.Test.check_exn test;;

Exception:
  test `All lists are sorted` failed on ‚â• 1 cases:
  [1; 0] (after 5 shrink steps)</code></pre><ul><li>Generate 20 random trees using <a href="Gen/index.html#val-fix"><code>Gen.fix</code></a> :</li></ul><pre><code>type tree = Leaf of int | Node of tree * tree

let leaf x = Leaf x
let node x y = Node (x,y)

let tree_gen = QCheck2.Gen.(sized @@ fix
                              (fun self n -&gt; match n with
                                 | 0 -&gt; map leaf nat
                                 | n -&gt;
                                   frequency
                                     [1, map leaf nat;
                                      2, map2 node (self (n/2)) (self (n/2))]
                              ));;

QCheck2.Gen.generate ~n:20 tree_gen;;</code></pre><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.18</li></ul><div class="odoc-spec"><div class="spec module" id="module-Tree" class="anchored"><a href="#module-Tree" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Tree/index.html">Tree</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A tree represents a generated value and its successive shrunk values.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Gen" class="anchored"><a href="#module-Gen" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Gen/index.html">Gen</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A generator is responsible for generating pseudo-random values and provide shrinks (smaller values) when a test fails.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Print" class="anchored"><a href="#module-Print" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Print/index.html">Print</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Printing functions and helpers, used to print generated values on test failures.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Shrink" class="anchored"><a href="#module-Shrink" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Shrink/index.html">Shrink</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Shrinking helper functions.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Observable" class="anchored"><a href="#module-Observable" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Observable/index.html">Observable</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>An observable is a random function <i>argument</i>.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Tuple" class="anchored"><a href="#module-Tuple" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Tuple/index.html">Tuple</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Utils on combining function arguments.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-fun_repr" class="anchored"><a href="#type-fun_repr" class="anchor"></a><code><span><span class="keyword">type</span> <span>'f fun_repr</span></span></code></div><div class="spec-doc"><p>Used by QCheck to shrink and print generated functions of type <code>'f</code> in case of test failure. You cannot and should not use it yourself. See <a href="#type-fun_"><code>fun_</code></a> for more information.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-fun_" class="anchored"><a href="#type-fun_" class="anchor"></a><code><span><span class="keyword">type</span> <span>'f fun_</span></span><span> = </span></code><table><tr id="type-fun_.Fun" class="anchored"><td class="def variant constructor"><a href="#type-fun_.Fun" class="anchor"></a><code><span>| </span><span><span class="constructor">Fun</span> <span class="keyword">of</span> <span><span class="type-var">'f</span> <a href="#type-fun_repr">fun_repr</a></span> * <span class="type-var">'f</span></span></code></td></tr></table></div><div class="spec-doc"><p>A function packed with the data required to print/shrink it.</p><p>The idiomatic way to use any <code>fun_</code> Gen.t is to directly pattern match on it to obtain the executable function.</p><p>For example (note the <code>Fun (_, f)</code> part):</p><pre><code>QCheck2.(Test.make
  Gen.(pair (fun1 Observable.int bool) (small_list int))
  (fun (Fun (_, f), l) -&gt; l = (List.rev_map f l |&gt; List.rev l))</code></pre><p>In this example <code>f</code> is a generated function of type <code>int -&gt; bool</code>.</p><p>The ignored part <code>_</code> of <code>Fun (_, f)</code> is useless to you, but is used by QCheck during shrinking/printing in case of test failure.</p><p>See also <a href="Fn/index.html"><code>Fn</code></a> for utils to print and apply such a function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-fun1" class="anchored"><a href="#val-fun1" class="anchor"></a><code><span><span class="keyword">val</span> fun1 : <span><span><span class="type-var">'a</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?print:<span><span class="type-var">'b</span> <a href="Print/index.html#type-t">Print.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-fun_">fun_</a></span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p><code>fun1 obs gen</code> generates random functions that take an argument observable via <code>obs</code> and map to random values generated with <code>gen</code>. To write functions with multiple arguments, it's better to use <a href="Tuple/index.html"><code>Tuple</code></a> or <a href="Observable/index.html#val-pair"><code>Observable.pair</code></a> rather than applying <a href="#type-fun_"><code>fun_</code></a> several times (shrinking will be faster).</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-fun2" class="anchored"><a href="#val-fun2" class="anchor"></a><code><span><span class="keyword">val</span> fun2 : <span><span><span class="type-var">'a</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?print:<span><span class="type-var">'c</span> <a href="Print/index.html#type-t">Print.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'c</span>)</span> <a href="#type-fun_">fun_</a></span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p>Specialized version of <a href="#val-fun_nary"><code>fun_nary</code></a> for functions of 2 arguments, for convenience.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-fun3" class="anchored"><a href="#val-fun3" class="anchor"></a><code><span><span class="keyword">val</span> fun3 : <span><span><span class="type-var">'a</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?print:<span><span class="type-var">'d</span> <a href="Print/index.html#type-t">Print.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'d</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'d</span>)</span> <a href="#type-fun_">fun_</a></span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p>Specialized version of <a href="#val-fun_nary"><code>fun_nary</code></a> for functions of 3 arguments, for convenience.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-fun4" class="anchored"><a href="#val-fun4" class="anchor"></a><code><span><span class="keyword">val</span> fun4 : <span><span><span class="type-var">'a</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'c</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'d</span> <a href="Observable/index.html#type-t">Observable.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?print:<span><span class="type-var">'e</span> <a href="Print/index.html#type-t">Print.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'e</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'b</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'c</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'d</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'e</span>)</span> <a href="#type-fun_">fun_</a></span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p>Specialized version of <a href="#val-fun_nary"><code>fun_nary</code></a> for functions of 4 arguments, for convenience.</p><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-fun_nary" class="anchored"><a href="#val-fun_nary" class="anchor"></a><code><span><span class="keyword">val</span> fun_nary : <span><span><span class="type-var">'a</span> <a href="Tuple/index.html#type-obs">Tuple.obs</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?print:<span><span class="type-var">'b</span> <a href="Print/index.html#type-t">Print.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'b</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span><span><span class="type-var">'a</span> <a href="Tuple/index.html#type-t">Tuple.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'b</span>)</span> <a href="#type-fun_">fun_</a></span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p><code>fun_nary tuple_obs gen</code> generates random n-ary functions. Arguments are observed using <code>tuple_obs</code> and return values are generated using <code>gen</code>.</p><p>Example (the property is wrong as a random function may return <code>false</code>, this is for the sake of demonstrating the syntax):</p><pre><code>let module O = Observable in
Test.make
  (fun_nary Tuple.(O.int @-&gt; O.float @-&gt; O.string @-&gt; o_nil) bool)
  (fun (Fun (_, f)) -&gt; f Tuple.(42 @:: 17.98 @:: &quot;foobar&quot; @:: nil))</code></pre><p>Note that this particular example can be simplified using <a href="#val-fun3"><code>fun3</code></a> directly:</p><pre><code>let module O = Observable in
Test.make
  (fun3 O.int O.float O.string bool)
  (fun (Fun (_, f)) -&gt; f 42 17.98 &quot;foobar&quot;)</code></pre><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec module" id="module-Fn" class="anchored"><a href="#module-Fn" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Fn/index.html">Fn</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Utils on generated functions.</p></div></div><h3 id="assumptions"><a href="#assumptions" class="anchor"></a>Assumptions</h3><div class="odoc-spec"><div class="spec value" id="val-assume" class="anchored"><a href="#val-assume" class="anchor"></a><code><span><span class="keyword">val</span> assume : <span>bool <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>assume cond</code> checks the precondition <code>cond</code>, and does nothing if <code>cond=true</code>. If <code>cond=false</code>, it interrupts the current test (but the test will not be failed).</p><p>‚ö†Ô∏è This function must only be used in a test, not outside. Example:</p><pre><code>Test.make (list int) (fun l -&gt;
    assume (l &lt;&gt; []);
    List.hd l :: List.tl l = l)</code></pre><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.5.1</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-(==&gt;)" class="anchored"><a href="#val-(==&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (==&gt;) : <span>bool <span class="arrow">&#45;&gt;</span></span> <span>bool <span class="arrow">&#45;&gt;</span></span> bool</span></code></div><div class="spec-doc"><p><code>b1 ==&gt; b2</code> is the logical implication <code>b1 =&gt; b2</code> ie <code>not b1 || b2</code> (except that it is strict and will interact better with <a href="Test/index.html#val-check_exn"><code>Test.check_exn</code></a> and the likes, because they will know the precondition was not satisfied.).</p><p>‚ö†Ô∏è This function should only be used in a property (see <a href="Test/index.html#val-make"><code>Test.make</code></a>), because it raises a special exception in case of failure of the first argument, to distinguish between failed test and failed precondition. Because of OCaml's evaluation order, both <code>b1</code> and <code>b2</code> are always evaluated; if <code>b2</code> should only be evaluated when <code>b1</code> holds, see <a href="#val-assume"><code>assume</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-assume_fail" class="anchored"><a href="#val-assume_fail" class="anchor"></a><code><span><span class="keyword">val</span> assume_fail : <span>unit <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p><code>assume_fail ()</code> is like <code>assume false</code>, but can take any type since we know it always fails (like <code>assert false</code>). This is useful to ignore some branches in <code>if</code> or <code>match</code>.</p><p>Example:</p><pre><code>Test.make (list int) (function
    | [] -&gt; assume_fail ()
    | _::_ as l -&gt; List.hd l :: List.tl l = l)</code></pre><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.5.1</li></ul></div></div><h2 id="tests"><a href="#tests" class="anchor"></a>Tests</h2><p>A test is a universal property of type <code>foo -&gt; bool</code> for some type <code>foo</code>, with an object of type <code>foo Gen.t</code> used to generate values of type <code>foo</code>.</p><p>See <a href="Test/index.html#val-make"><code>Test.make</code></a> to build a test, and <a href="Test/index.html#val-check_exn"><code>Test.check_exn</code></a> to run one test simply. For more serious testing, it is better to create a testsuite and use <code>QCheck_runner</code>.</p><div class="odoc-spec"><div class="spec type" id="type-stat" class="anchored"><a href="#type-stat" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a stat</span></span><span> = string * <span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> int)</span></span></code></div><div class="spec-doc"><p>A statistic on a distribution of values of type <code>'a</code>. The function <b>MUST</b> return a positive integer.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-TestResult" class="anchored"><a href="#module-TestResult" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="TestResult/index.html">TestResult</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Result of running a test</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Test_exceptions" class="anchored"><a href="#module-Test_exceptions" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Test_exceptions/index.html">Test_exceptions</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Test" class="anchored"><a href="#module-Test" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Test/index.html">Test</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>A test is a pair of an generator and a property thar all generated values must satisfy.</p></div></div><h3 id="sub-tests"><a href="#sub-tests" class="anchor"></a>Sub-tests</h3><p>The infrastructure used to find counter-examples to properties can also be used to find data satisfying a predicate, <i>within a property being tested</i>.</p><p>See https://github.com/c-cube/qcheck/issues/31</p><div class="odoc-spec"><div class="spec exception" id="exception-No_example_found" class="anchored"><a href="#exception-No_example_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">No_example_found</span> <span class="keyword">of</span> string</span></code></div><div class="spec-doc"><p>Raised by <a href="#val-find_example"><code>find_example</code></a> and <a href="#val-find_example_gen"><code>find_example_gen</code></a> if no example was found.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-find_example" class="anchored"><a href="#val-find_example" class="anchor"></a><code><span><span class="keyword">val</span> find_example : <span>?name:string <span class="arrow">&#45;&gt;</span></span> <span>?count:int <span class="arrow">&#45;&gt;</span></span> <span>f:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Gen/index.html#type-t">Gen.t</a></span></span></code></div><div class="spec-doc"><p><code>find_example ~f gen</code> uses <code>gen</code> to generate some values of type <code>'a</code>, and checks them against <code>f</code>. If such a value is found, it is returned. Otherwise an exception is raised.</p><p>‚ö†Ô∏è This should only be used from within a property in <a href="Test/index.html#val-make"><code>Test.make</code></a>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">name</span> <p>Description of the example to find (used in test results/errors).</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">count</span> <p>Number of attempts.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">f</span> <p>The property that the generated values must satisfy.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">No_example_found</span> <p>If no example is found within <code>count</code> tries.</p></li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-find_example_gen" class="anchored"><a href="#val-find_example_gen" class="anchor"></a><code><span><span class="keyword">val</span> find_example_gen : <span>?rand:<span class="xref-unresolved">Stdlib</span>.Random.State.t <span class="arrow">&#45;&gt;</span></span> <span>?name:string <span class="arrow">&#45;&gt;</span></span> <span>?count:int <span class="arrow">&#45;&gt;</span></span>
<span>f:<span>(<span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> bool)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Gen/index.html#type-t">Gen.t</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div><div class="spec-doc"><p>Toplevel version of <a href="#val-find_example"><code>find_example</code></a>. <code>find_example_gen ~f gen</code> is roughly the same as <code>Gen.generate1 @@ find_example ~f gen</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">rand</span> <p>the random state to use to generate inputs.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">No_example_found</span> <p>if no example was found within <code>count</code> tries.</p></li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.6</li></ul></div></div><h2 id="migration_qcheck2"><a href="#migration_qcheck2" class="anchor"></a>Migration to QCheck2</h2><p>QCheck2 is a major release and as such, there are (as few as possible) breaking changes, as well as functional changes you should be aware of.</p><h3 id="minimal-changes"><a href="#minimal-changes" class="anchor"></a>Minimal changes</h3><p>Most of your QCheck (v1) code should be able to compile and run the first time you upgrade your QCheck version to a QCheck2-compatible version. However you may need to do the following minimal changes:</p><ul><li><a href="../QCheck/Test/index.html#val-make"><code>QCheck.Test.make</code></a> return type was changed to <a href="Test/index.html#type-t"><code>QCheck2.Test.t</code></a> to be able to run both QCheck and QCheck2 tests together. This is transparent if you used type inference, but if you explicitly used <a href="../QCheck/Test/index.html#type-t"><code>QCheck.Test.t</code></a> you will need to change it to <a href="Test/index.html#type-t"><code>QCheck2.Test.t</code></a>.</li></ul><h3 id="recommended-changes"><a href="#recommended-changes" class="anchor"></a>Recommended changes</h3><p>Now you want to actually start using the QCheck2 features (most importantly: free shrinking!). To get started, change all your <a href="../QCheck/index.html"><code>QCheck</code></a> references to <a href="#"><code>QCheck2</code></a> and follow the compiler errors. Below are the most common situations you may encounter:</p><ul><li>as shrinking is now integrated, several function arguments like <code>~shrink</code> or <code>~rev</code> have been removed: you can remove such reverse functions, they will no longer be necessary.</li><li>accessor functions like <a href="../QCheck/index.html#type-arbitrary.gen"><code>QCheck.arbitrary.gen</code></a> have been renamed to consistent names like <code>get_gen</code>.</li><li><a href="../QCheck/index.html#val-map_keep_input"><code>QCheck.map_keep_input</code></a> has been removed: you can use <code>map</code> directly.</li><li><a href="Gen/index.html#type-t"><code>Gen.t</code></a> is no longer public, it is now abstract: it is recommended to use <a href="Gen/index.html#composing_generators">generator composition</a> to make generators. <a href="Gen/index.html#val-make_primitive"><code>Gen.make_primitive</code></a> was added to create generators with finer control (in particular of shrinking).</li></ul></div></body></html>