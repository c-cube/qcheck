<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Shrink (qcheck-core.QCheck2.Shrink)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">qcheck-core</a> &#x00BB; <a href="../index.html">QCheck2</a> &#x00BB; Shrink</nav><header class="odoc-preamble"><h1>Module <code><span>QCheck2.Shrink</span></code></h1><p>Shrinking helper functions.</p><p>Shrinking is used to reduce the size of a counter-example. It tries to make the counter-example smaller by decreasing it, or removing elements, until the property to test holds again; then it returns the smallest value that still made the test fail.</p><p>This is meant to help developers find a simpler counter-example to ease investigation and find more easily the root cause (be it in the tested code or in the test).</p><p>This module exposes helper functions that one can reuse in combination with <a href="../Gen/index.html#val-make_primitive"><code>Gen.make_primitive</code></a> to craft custom primitive generators (not by composing other generators). The vast majority of use cases will probably not need this module.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module-type" id="module-type-Number" class="anchored"><a href="#module-type-Number" class="anchor"></a><code><span><span class="keyword">module</span> <span class="keyword">type</span> <a href="module-type-Number/index.html">Number</a></span><span> = <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Util module representing a number type, used for ad hoc polymorphism of some functions like <a href="#val-number_towards"><code>number_towards</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-number_towards" class="anchored"><a href="#val-number_towards" class="anchor"></a><code><span><span class="keyword">val</span> number_towards : 
  <span><span>(<span class="keyword">module</span> <a href="module-type-Number/index.html">Number</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="module-type-Number/index.html#type-t">t</a> = <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span>
  <span>destination:<span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p>Shrink a number by edging towards a destination.</p><p>The destination is always the first value for optimal shrinking.</p><pre><code>let int64_towards_list destination x = List.of_seq @@
  Gen.number_towards (module Int64) ~destination x
in
assert (int64_towards_list 0L 100L =
        [0L; 50L; 75L; 88L; 94L; 97L; 99L]);
assert (int64_towards_list 500L 1000L =
        [500L; 750L; 875L; 938L; 969L; 985L; 993L; 997L; 999L]);
assert (int64_towards_list (-50L) (-26L) =
        [-50L; -38L; -32L; -29L; -28L; -27L])</code></pre><p>This generic function is exposed to let users reuse this shrinking technique for their custom number types. More specialized, convenient functions are provided below, e.g. <a href="#val-int_towards"><code>int_towards</code></a>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int_towards" class="anchored"><a href="#val-int_towards" class="anchor"></a><code><span><span class="keyword">val</span> int_towards : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p><a href="#val-number_towards"><code>number_towards</code></a> specialized to <code>int</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int32_towards" class="anchored"><a href="#val-int32_towards" class="anchor"></a><code><span><span class="keyword">val</span> int32_towards : <span>int32 <span class="arrow">&#45;&gt;</span></span> <span>int32 <span class="arrow">&#45;&gt;</span></span> <span>int32 <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p><a href="#val-number_towards"><code>number_towards</code></a> specialized to <code>int32</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int64_towards" class="anchored"><a href="#val-int64_towards" class="anchor"></a><code><span><span class="keyword">val</span> int64_towards : <span>int64 <span class="arrow">&#45;&gt;</span></span> <span>int64 <span class="arrow">&#45;&gt;</span></span> <span>int64 <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p><a href="#val-number_towards"><code>number_towards</code></a> specialized to <code>int64</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-float_towards" class="anchored"><a href="#val-float_towards" class="anchor"></a><code><span><span class="keyword">val</span> float_towards : <span>float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="arrow">&#45;&gt;</span></span> <span>float <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p><a href="#val-number_towards"><code>number_towards</code></a> specialized to <code>float</code>.</p><p>There are various ways to shrink a float:</p><ul><li>try removing floating digits, i.e. towards integer values</li><li>try to get as close as possible to the destination, no matter the number of digits</li><li>a mix of both</li></ul><p>This implementation, as it relies on the generic <a href="#val-number_towards"><code>number_towards</code></a> function, tries to get as close as possible to the destination, e.g. the last value of <code>Gen.float_towards 50 100</code> may be <code>99.9969482421875</code> (or a similar value).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int_aggressive_towards" class="anchored"><a href="#val-int_aggressive_towards" class="anchor"></a><code><span><span class="keyword">val</span> int_aggressive_towards : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><p><code>int_agressive_towards destination n</code> gives all integers from <code>destination</code> to <code>n</code> (excluded).</p><p><b>Be careful about time and memory</b> as the resulting list can be huge</p></div></div><div class="odoc-spec"><div class="spec value" id="val-int_aggressive" class="anchored"><a href="#val-int_aggressive" class="anchor"></a><code><span><span class="keyword">val</span> int_aggressive : <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Stdlib</span>.Seq.t</span></span></code></div><div class="spec-doc"><ul class="at-tags"><li class="deprecated"><span class="at-tag">deprecated</span> <p>Use <code>int_aggressive_towards 0</code> instead.</p></li></ul><ul class="at-tags"><li class="since"><span class="at-tag">since</span> 0.7</li></ul></div></div></div></body></html>